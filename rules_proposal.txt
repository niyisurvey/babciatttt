GENERIC REPLACEMENT RULES AND CI ENFORCEMENT

A) Replacement rules by category (language-agnostic intent)

1. Colors
- Rule: Replace literal colors (e.g., Color(...), .red, .blue, .white) with semantic palette tokens.
- Replacement: theme.palette.<semantic>
- Gradient exception: if used in gradient arrays, replace entire gradient with theme.backgrounds.gradient.<name>.

2. Semantic system colors (.secondary/.tertiary)
- Rule: Replace with explicit semantic tokens when branding consistency is required.
- Replacement: theme.palette.text.secondary (or theme.palette.border.subtle depending on role).
- Mark as separate class in linting to allow gradual migration.

3. Opacity
- Rule: Replace literal opacity values with elevation/overlay tokens.
- Replacement: theme.elevation.overlay.dim / theme.elevation.shadow.opacity.levelX / theme.elevation.glass.tintOpacity.

4. Shadows
- Rule: Replace .shadow(...) literal parameters with elevation presets.
- Replacement: theme.elevation.level1/level2/level3 presets or individual tokens.

5. Spacing and layout numerics
- Rule: Replace numeric spacing values with grid scale tokens.
- Replacement: theme.grid.<scale>
- Approach: map numeric literal to nearest grid token and review visually.

6. Shape / radius
- Rule: Replace literal corner radii with shape tokens.
- Replacement: theme.shape.card / theme.shape.control / theme.shape.hero etc.

7. Typography
- Rule: Replace .font(.system(...)) and direct .font(.title) etc with semantic typography tokens.
- Replacement: theme.typography.<style>

8. Gradients
- Rule: Replace literal gradient color arrays with background gradient tokens.
- Replacement: theme.backgrounds.gradient.<name>

9. Button styles and foregroundStyle literals
- Rule: Replace literal colors passed to styles, tint, and foregroundStyle.
- Replacement: theme.palette.buttonPrimary / theme.palette.icon.primary / theme.palette.text.primary.

B) Suggested codemod patterns

These are detection-oriented patterns; safe replacement typically requires AST tooling.

1) Colors
- Regex: Color\(|\.(black|white|red|orange|blue|green|teal|cyan|purple|pink|indigo|mint|yellow|brown)
- AST pattern: MemberAccessExpr(Color literal) or FunctionCallExpr(Color initializer).
- Tooling note: SwiftSyntax recommended for safe replacement to avoid enum cases unrelated to Color.

2) Semantic colors
- Regex: \.(secondary|tertiary)\b
- AST pattern: MemberAccessExpr named secondary/tertiary on Color/ShapeStyle.

3) Opacity
- Regex: \.opacity\(\s*([0-9]*\.?[0-9]+)\s*\)
- AST pattern: FunctionCallExpr on opacity with numeric literal argument.

4) Shadows
- Regex: \.shadow\(
- AST pattern: FunctionCallExpr named shadow.

5) Spacing / layout numerics
- Regex: padding\(\s*\d+|padding\(\.\w+,\s*\d+|spacing:\s*\d+|frame\([^)]*(width|height):\s*\d+|offset\([^)]*(x|y):\s*\d+
- AST pattern: FunctionCallExpr padding/frame/offset with numeric literals; LabeledExpr "spacing" with numeric literal.
- Tooling note: SwiftSyntax recommended because some numeric literals are not UI primitives.

6) Shape / radius
- Regex: cornerRadius:\s*\d+|RoundedRectangle\(cornerRadius:\s*\d+
- AST pattern: RoundedRectangle init with numeric literal radius.

7) Typography
- Regex: \.font\(\.system|\.font\(\.(largeTitle|title|title2|title3|headline|subheadline|caption|caption2|body|callout|footnote)
- AST pattern: font modifier with system or direct style.

8) Gradients
- Regex: LinearGradient\(colors:\s*\[|Gradient\(colors:\s*\[
- AST pattern: gradient initializers with literal color arrays.

C) CI enforcement examples

1) Ripgrep CI checks (fast fail)

Example script (bash):

rg -n "Color\(|\.(black|white|red|orange|blue|green|teal|cyan|purple|pink|indigo|mint|yellow|brown)" --glob "*.swift" --hidden \
  --glob '!Tests/**' --glob '!LiquidGlassLab/**' --glob '!External/**' --glob '!TempDreamStuff/**' --glob '!.git/**' && exit 1 || exit 0

rg -n "padding\(\s*\d+|spacing:\s*\d+|cornerRadius:\s*\d+|\.font\(\.system" --glob "*.swift" --hidden \
  --glob '!Tests/**' --glob '!LiquidGlassLab/**' --glob '!External/**' --glob '!TempDreamStuff/**' --glob '!.git/**' && exit 1 || exit 0

2) SwiftLint custom rules (example)

custom_rules:
  no_literal_colors:
    name: "No literal colors"
    regex: "Color\(|\\.(black|white|red|orange|blue|green|teal|cyan|purple|pink|indigo|mint|yellow|brown)"
    message: "Use theme palette tokens instead of literal colors."
    severity: error

  no_literal_spacing:
    name: "No literal spacing"
    regex: "padding\\(\\s*\\d+|spacing:\\s*\\d+|cornerRadius:\\s*\\d+"
    message: "Use theme grid/shape tokens instead of numeric literals."
    severity: warning

  no_system_fonts:
    name: "No system font literals"
    regex: "\\.font\\(\\.system|\\.font\\(\\.(title|headline|body|caption)"
    message: "Use theme typography tokens instead of system font literals."
    severity: warning

3) PR visual diff policy (process enforcement)
- Require screenshots or visual diffs when UI files change.
- Automation options:
  - CI checks for changed SwiftUI view files and require a PR checklist item.
  - Danger rule: if files under Features/ or Shared/Components/ change and no screenshot is attached, fail.

D) Automation vs manual verification guidance
- Safe to automate detection; replacements that change layout, gradients, or typography require manual visual verification.
- SwiftSyntax (or equivalent AST) is strongly recommended for replacement to avoid false positives in enums and non-UI contexts.
